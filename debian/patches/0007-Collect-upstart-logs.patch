From 7b941c76f289595936c33e5f69d0c1191987dd3f Mon Sep 17 00:00:00 2001
From: Louis Bouchard <louis.bouchard@canonical.com>
Date: Thu, 28 Aug 2014 12:41:32 +0200
Subject: Collect upstart logs

Description: Collect upstart logs

Author: Louis Bouchard <louis.bouchard@canonical.com>
Bug-Ubuntu: http://bugs.launchpad.net/bugs/1309679
Origin: upstream, https://github.com/sosreport/sos/commit/8aed05343ae69931adf823d093f16c1d247f2908
---
 sos/plugins/upstart.py | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/sos/plugins/upstart.py b/sos/plugins/upstart.py
index 5aa0e1d..db49730 100644
--- a/sos/plugins/upstart.py
+++ b/sos/plugins/upstart.py
@@ -23,6 +23,9 @@ class Upstart(Plugin, RedHatPlugin, DebianPlugin, UbuntuPlugin):
     plugin_name = 'upstart'
     packages = ('upstart',)
 
+    option_list = [("logsize", "maximum size (MiB) of logs to collect",
+                   "", 15)]
+
     def setup(self):
         self.add_cmd_output('initctl --system list')
         self.add_cmd_output('initctl --system version')
@@ -36,6 +39,9 @@ class Upstart(Plugin, RedHatPlugin, DebianPlugin, UbuntuPlugin):
         # State file
         self.add_copy_spec('/var/log/upstart/upstart.state')
 
+        # Log files
+        self.add_copy_spec_limit('/var/log/upstart/*',
+                                 sizelimit=self.get_option('logsize'))
         # Session Jobs (running Upstart as a Session Init)
         self.add_copy_spec('/usr/share/upstart/')
 
